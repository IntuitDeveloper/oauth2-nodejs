<html>
<head>
  <title>OAuth2 Sample App - Intuit</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script>
    if(window.opener) {
      window.opener.location.href = '/connected'
      window.close()
    }

    function apiCall() {
      $("#result").html('Loading...')
      $.get("/api_call", function(data) {
        $("#result").html(JSON.stringify(data, null, 2))
      })
    }
    function revokeCall() {
      $("#result").html('Loading...')
      $.get("/api_call/revoke", function(data) {
        $("#result").html(JSON.stringify(data, null, 2))
      })
    }
    function refreshCall() {
      $("#result").html('Loading...')
      $.get("/api_call/refresh", function(data) {
        $("#result").html(JSON.stringify(data, null, 2))
      })
    }
    function getcustomerCall() {
      $("#result").html('Loading...')
      var query="select * from Customer";
      $.get("/api_call/getCustomer", function(data) {
        $("#result").html(JSON.stringify(data, null, 2))
      })
    }
    function getallinvoicesCalls() {
      $("#result").html('Loading...');      
      $.get("/api_call/getAllInvoices", function(data) {
        $("#result").html(JSON.stringify(data, null, 2))
      })
    }
    function getinvoiceCall() {
      $("#result").html('Loading...');      
      $.get("/api_call/getInvoice", function(data) {
        $("#result").html(JSON.stringify(data.Invoice.Line, null, 2))
      })
    }

  var customer =  [{
  "FullyQualifiedName": "Komal Arya", 
  "PrimaryEmailAddr": {
    "Address": "komal76east@gmail.com"
  }, 
  "DisplayName": "Komal Arya", 
  "Suffix": "", 
  "Title": "Ms", 
  "MiddleName": "", 
  "Notes": "Here are other details.", 
  "FamilyName": "Kamboj", 
  "PrimaryPhone": {
    "FreeFormNumber": "(555) 555-5555"
  }, 
  "CompanyName": "76EAST", 
  "BillAddr": {
    "CountrySubDivisionCode": "CA", 
    "City": "Mountain View", 
    "PostalCode": "94042", 
    "Line1": "123 Main Street", 
    "Country": "USA"
  }, 
  "GivenName": "Komal"
}]

    function createCustomerCall() {
     // $("#result").html('Loading...');    
      console.log("customer details =");
      console.log(customer);  
      // $.get("/api_call/createCustomer/:"+customer, function(req, data) {
      //   $("#result").html(JSON.stringify(data, null, 2))
      // })
    }

  </script>
</head>
<body>
  <a href="/">Home</a>
  <h3>Connected!</h3>
  <p>Welcome<% if (locals.givenName) { %>, <%= locals.givenName %><% } %>!</p>
  <p>Would you like to make a sample API call?</p>
  <div>
    <button onclick="apiCall()">QuickBooks API Call</button>
    <button onclick="refreshCall()">Refresh Token Call</button>
    <button onclick="revokeCall()">Revoke Token Call</button>    
    <br><br>
    <button onclick="getcustomerCall()">Get Customers</button>
    <button onclick="getallinvoicesCalls()">Get All Invoices</button>
    <button onclick="getinvoiceCall()">Get Invoice</button>
    <br><br>
    <button onclick="createCustomerCall()">Create Customer</button>
    <br><br>
    <div><code id="result"></code></div>
</body>
</html>
